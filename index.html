<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>The Rust Programming Language</title>

    <meta name="description" content="A short intro to Rust for C++ programmers">
    <meta name="author" content="Kai Michaelis">
    <meta name="author" content="Benjamin Kircher">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/solarized.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section>
          <h1>Rust</h1>
          <h3>Intro for C++ programmers</h3>
          <img src="http://www.rust-lang.org/logos/rust-logo-256x256.png" alt="Rust logo">
          <p>
            <small>Created by <a href="https://github.com/flanfly">Kai</a> / <a href="http://twitter.com/_cibo_">@_cibo_</a></small>
            <small>and <a href="https://github.com/bkircher">Ben</a> / <a href="http://twitter.com/predatorhat">@predatorhat</a></small>
          </p>
        </section>

        <section>
          <pre><code class="rust" data-trim contenteditable>
fn main() {
    println!("Hello, there!");
}
          </code></pre>
        </section>

        <section>
          <ul>
            <li>No garbage collector</li>
            <li>No big runtime</li>
            <li>RAII everywhere</li>
            <li>Zero-cost abstractions</li>
          </ul>
        </section>

        <!-- Rust language concepts are very familiar if you come from a C++
          background.

          You have heap and stack allocation, type inference, automatic memory,
          ownership concepts, destructors, and low-level features!
        -->
        <section>
          <table>
            <thead>
              <tr>
                <th>C++</th>
                <th>Rust</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>auto x = 42;</td>
                <td>let x = 42;</td>
              <tr>
              <tr>
                <td>std::unique_ptr&lt;T&gt;</td>
                <td>Box&lt;T&gt;</td>
              <tr>
              <tr>
                <td>std::shared_ptr&lt;T&gt;</td>
                <td>Rc&lt;T&gt; and Arc&lt;T&gt;</td>
              <tr>
              <tr>
                <td>Destructors</td>
                <td>trait Drop</td>
              <tr>
              <tr>
                <td>__asm</td>
                <td>asm! macro</td>
              <tr>
            </tbody>
          </table>
        </section>

        <!-- Besides expressiveness and all those nice little features.
        -->
        <section>
          <h3>Selling Point?</h3>
          <p>Quite similar to C++. So why do we need another language?</p>
        </section>

        <!-- C++ adds to C's type system, which is nearly as weak as
          JavaScript's ;-)

          In fact, idiomatic C++ tries to increase type richness. Instead of
          int milliseconds you write std::chrono::milliseconds, right?

          Why do we have type system's at all? To prevent bugs!
        -->
        <section>
          <h3>Selling Point?</h3>
          <p><b>Rust's type system!</b></p>
        </section>

        <!-- Actually, Rust's type system can eliminate a whole class of
          typical nasty bugs!
        -->

        <section>
          <pre><code class="cpp">
void logError(const char* msg, int* ints) {
    fprintf(stderr, "%s: %i\n", msg, ints[0]);
}

int main() {
    int* ptr = (int*)malloc (SIZE);
    // ...
    if (err) {
        abrt = 1;
        free(ptr);
    }
    // ...
    if (abrt) {
        logError("operation aborted before commit", ptr);
    }
}
          </code></pre>
          <p>
            <a href="http://cwe.mitre.org/data/definitions/416.html">CWE-416: Use After Free</a>
          </p>
        </section>

        <!-- Not just an error! It has security implications! -->

        <section>
          <img src="static/use-after-free-1.png" alt="Heap use after free"/>
        </section>

        <section>
          <img src="static/use-after-free-2.png" alt="Heap use after free with ASAN"/>
        </section>

        <section>
          <p>To catch this in C or C++ you need</p>
          <ul>
            <li>Something like ASAN and/or Valgrind's Memcheck</li>
            <li>Good test coverage</li>
            <li>And you need to run those tests</li>
            <li>If code is in one TU: static code analysis <em>might</em> help</li>
          </ul>
        </section>

        <section>
          <p>In Rust, lifetime is part of an object's type</p>
          <pre><code class="rust">
fn main() {
    let x;

    {
        let y = 5;
        x = &y;
    }

    println!("x's value is {}", x);
}
          </pre></code>
        </section>

        <section>
          <p>And thus, checked at compile time</p>
          <img src="static/lifetime.png" alt="rustc compile error"/>
        </section>

        <section>
          <p>More examples</p>
        </section>

        <!--
struct Foo<'a> {
    x: &'a i32,
}

fn main() {
    let x;

    {
        let y = &5;
        let f = Foo { x: y };
        x = &f.x;
    }

    println!("x's value is {}", x);
}
        -->

        <section>
          <h2>Who is using Rust?</h2>
          <ul>
            <li>rustc</li>
            <li>Mozilla Servo browser engine</li>
            <li>Skylight, a profiler for Rails apps</li>
          </ul>
        </section>

        <section>
          <h2>Libraries?</h2>
          <p>
            <a href="https://crates.io/">https://crates.io/</a>
          </p>
          <img src="static/crates.png" alt="crates.io site screenshot">
        </section>

        <section>
          <h2>FFI?</h2>
        </section>

        <section>
          <h2>Small Peek Into Error Handling</h2>
        </section>

        <section>
          <p><a href="http://doc.rust-lang.org/stable/std/macro.panic!.html">panic!</a> unwinds the thread</p>
          <pre><code class="rust" data-trim contenteditable>
fn guess(n: i32) -&gt; bool {
    if n < 1 || n > 10 {
        panic!("Invalid number: {}", n);
    }
    n == 5
}

fn main() {
    guess(11);
}
          </code></pre>
        </section>

        <section>
          <p>
            <a href="http://doc.rust-lang.org/stable/std/option/enum.Option.html">std::option::Option</a>
          </p>
          <pre><code class="rust" data-trim contenteditable>
enum Option&lt;T&gt; {
    None,
    Some(T),
}
          </code></pre>
        </section>

        <section>
          <p>Option&lt;T&gt;</p>
          <pre><code class="rust" data-trim contenteditable>
fn find(haystack: &amp;str, needle: char) -&gt; Option&lt;usize&gt; {
    for (offset, c) in haystack.char_indices() {
        if c == needle {
            return Some(offset);
        }
    }
    None
}

fn main() {
    let filename = "foobar.txt";
    match find(filename, '.') {
        Some(i) =&gt; println!("Filename extension: {}", &amp;filename[i+1..]),
        None =&gt; println!("No extension found!"),
    }
}
          </code></pre>
        </section>

        <section>
          <h2>Thoughts on Error Handling in Rust</h2>
          <p>Somewhat mixed...</p>
          <ol>
            <li>Way better than arbitrary return values</li>
            <li>Seems harder to use than exceptions</li>
            <li>Anyone?</li>
          </ol>
        </section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>

    <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true },
          { src: 'plugin/notes/notes.js', async: true }
        ]
      });

    </script>

  </body>
</html>
